<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="keywords" content="online documentation, web online help, web help, chm2web" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="generator" content="chm2web Pro 2.85 (unicode)" />

<meta http-equiv="Content-Language" content="en">
<title>Avoid using streadd() function</title>
<link rel="stylesheet" href="../../../../files/helpindex.css" type=
"text/css">
<link rel="stylesheet" href="../../../../default.css" type=
"text/css">

<script type="text/JavaScript" src="../../../../files/supply.js"></script>
<script type="text/JavaScript">
chmtop.c2wtopf.pageid = "66030/66031/66063/7986.htm";
</script>

</head>
<body><script type="text/JavaScript"> 
if (window.name != "content") 
  document.write(" <table width=\"100%\" bgcolor=\"#e1e1e1\"cellspacing=\"2\" cellpadding=\"0\" style=\"border-collapse: collapse; font-family: sans-serif; font-size: 14px; color: #000000; text-decoration: none;  \"> <tr> <td align=\"center\" style=\"border-bottom: 2px solid gray\" > <br>&nbsp;Click <a href=\"../../../../index.html?page=source%2F66030%2F66031%2F66063%2F7986.htm\">here</a> to show toolbars of the Web Online Help System: <a href=\"../../../../index.html?page=source%2F66030%2F66031%2F66063%2F7986.htm\">show toolbars</a><br>&nbsp;</td></tr></table><br> "); 
</script>
<!-- !chm2web! -->

<h4>Avoid using streadd() function</h4>

<hr>

<h5>Technology</h5>

<p>C Language, C++</p>

<h5>Unified Status</h5>

<p>Unified</p>

<h5>XXL Status</h5>

<p>N/A</p>

<h5>Critical Quality Rule</h5>

<p>No</p>

<h5>Weight in Parent Tech. Criterion</h5>

<p>6</p>

<h5>Rationale</h5>

<p>The 'streadd()' function can lead to security risk because there
is possibility to overflow the target string. The risk for this
function is high because a simple test of the size of the source
string is not enough to be sure that the target string is large
enough.</p>

<h5>Description</h5>

<p>This rule searches for C/C++ functions, methods, constructors,
and destructors that call the 'streadd()' function.</p>

<h5>Remediation</h5>

<p>Check the bounds of the target string buffer to make sure that
it is large enough to receive the source string after this one is
expanded. The target string buffer should be at least four times
larger than the source string buffer.</p>

<h5>Reference</h5>

<p>Build Security In
(https://buildsecurityin.us-cert.gov/bsi/articles/knowledge/coding)</p>

<h5>Sample</h5>

<pre>
void foo()
{
  char strSource[100]="string with some expandable\t\tcharacters\n\n";
  char strTarget[*100];
  streadd(strTarget,strSource,theExceptions);
}
</pre>

<h5>Remediation sample</h5>

<pre>
void foo()
{
  char strSource[100]="string with some expandable\t\tcharacters\n\n";
  char strTarget[4*100];
  streadd(strTarget,strSource,theExceptions);
}
</pre>

<h5>Output</h5>

<p>Associated to each C/C++ function/method/constructor/destructor
with violations, the Quality Rule provides: - Number of violation
patterns - Bookmarks for violation patterns found in the source
code: - 'streadd()' function call</p>

<h5>Total</h5>

<p>Number of C/C++ functions, constructors, destructors, and
methods</p>

<h5>Metric ID</h5>

<p>7986</p>

<hr>

<p align="right"><a href="http://www.castsoftware.com" target=
"_blank"><img border="0" src="../../../cast.gif" alt="CAST Website"
width="174" height="21"></a>
</p>

<script type="text/JavaScript">
var fe = FindFrame("toc", top);
if ((fe != null) && (chmtop.c2wtopf.jstree != null)) {
  if (chmtop.c2wtopf.FITEMS[chmtop.c2wtopf.pagenum] != chmtop.c2wtopf.pageid)
    chmtop.c2wtopf.jstree.OpenTreeNode("source/" + chmtop.c2wtopf.pageid);
}
</script>

<!-- CHM2WEB -->
<!-- DO NOT DELETE OR MODIFY THIS CODE WITHOUT 
     WRITTEN PERMISSION OF A!K RESEARCH LABS -->
<table width="100%" cellspacing="0" cellpadding="0" 
style="margin-top: 0pt; border-collapse: collapse;"> 
<tr> <td align="right" style="background-color:white; border-top: 1px solid gray;"> 
<a href="http://chm2web.aklabs.com" target="_blank" style="font-family: sans-serif;  font-size: 11px; text-decoration: none;"><font color="gray">Converted from CHM to HTML with <b>chm2web Pro 2.85 (unicode)</b></font></a>
</td></tr></table> 
<!-- /CHM2WEB -->

</body>
</html>
